<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Catalogue de V√©hicules</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-zinc-900 text-white font-sans">
    <div class="container mx-auto p-6">
      <div id="auth-section" class="mb-6"></div>

      <h1 class="text-4xl font-bold mb-8 text-center text-violet-400">Catalogue de V√©hicules</h1>

      <!-- Filtres -->
      <div class="flex flex-wrap justify-center gap-3 mb-6">
        <button class="filter-btn px-4 py-2 bg-violet-600 text-white rounded" data-category="all">Tout</button>
        <button class="filter-btn px-4 py-2 bg-zinc-700 hover:bg-violet-600 rounded" data-category="utilitaire">Utilitaire</button>
        <button class="filter-btn px-4 py-2 bg-zinc-700 hover:bg-violet-600 rounded" data-category="ordinaire">Ordinaire</button>
        <button class="filter-btn px-4 py-2 bg-zinc-700 hover:bg-violet-600 rounded" data-category="electrique">√âlectrique</button>
        <button class="filter-btn px-4 py-2 bg-zinc-700 hover:bg-violet-600 rounded" data-category="suv">SUV</button>
        <button class="filter-btn px-4 py-2 bg-zinc-700 hover:bg-violet-600 rounded" data-category="sport">Sport</button>
      </div>

      <!-- Tri -->
      <div class="flex justify-center mb-6">
        <select id="sort-select" class="p-2 bg-zinc-800 text-white border border-zinc-600 rounded">
          <option value="default">Trier par...</option>
          <option value="price-asc">Prix croissant</option>
          <option value="price-desc">Prix d√©croissant</option>
          <option value="speed-asc">Vitesse croissante</option>
          <option value="speed-desc">Vitesse d√©croissante</option>
        </select>
      </div>

      <!-- Liste -->
      <div id="vehicle-list" class="grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
    </div>

    <!-- POPUP COMMANDE -->
    <div id="order-popup" class="hidden fixed inset-0 bg-black/60 flex items-center justify-center z-50">
      <div class="bg-white p-6 rounded-lg text-black w-[300px]">
        <h2 class="text-xl font-bold mb-4">Choisir une couleur</h2>
        <div class="flex gap-3 mb-4">
          <div class="w-6 h-6 rounded-full bg-red-600 cursor-pointer" data-color="Rouge"></div>
          <div class="w-6 h-6 rounded-full bg-blue-600 cursor-pointer" data-color="Bleu"></div>
          <div class="w-6 h-6 rounded-full bg-black cursor-pointer" data-color="Noir"></div>
        </div>
        <button id="confirm-order" class="bg-violet-600 text-white px-4 py-2 rounded">Confirmer</button>
      </div>
    </div>

    <script>
      const vehicles = [...]; // Utilise tes donn√©es pr√©c√©dentes ici

      const authSection = document.getElementById("auth-section");
      const listEl = document.getElementById("vehicle-list");
      const filterBtns = document.querySelectorAll(".filter-btn");
      const sortSelect = document.getElementById("sort-select");
      const popup = document.getElementById("order-popup");
      let currentFilter = "all";
      let currentUser = JSON.parse(localStorage.getItem("user")) || null;
      let selectedColor = null;
      let selectedVehicle = null;

      function showLogin() {
        authSection.innerHTML = `
          <div class="bg-zinc-800 p-4 rounded mb-4 max-w-md mx-auto">
            <h2 class="text-xl font-bold mb-2">Connexion</h2>
            <input type="text" id="username" placeholder="Nom d'utilisateur" class="w-full p-2 mb-2 rounded bg-zinc-700 text-white" />
            <input type="password" id="password" placeholder="Mot de passe" class="w-full p-2 mb-2 rounded bg-zinc-700 text-white" />
            <select id="role" class="w-full p-2 mb-2 rounded bg-zinc-700 text-white">
              <option value="client">Client</option>
              <option value="concess">Membre concess</option>
            </select>
            <input type="text" id="code" placeholder="Code concess (si concess)" class="w-full p-2 mb-2 rounded bg-zinc-700 text-white" />
            <button onclick="register()" class="bg-violet-600 w-full p-2 rounded text-white">Cr√©er un compte</button>
          </div>
        `;
      }

      function register() {
        const username = document.getElementById("username").value;
        const password = document.getElementById("password").value;
        const role = document.getElementById("role").value;
        const code = document.getElementById("code").value;
        if (role === "concess" && code !== "CONCESS2025") return alert("Code incorrect !");
        const user = { username, role };
        localStorage.setItem("user", JSON.stringify(user));
        currentUser = user;
        renderAuth();
      }

      function renderAuth() {
        if (!currentUser) return showLogin();
        authSection.innerHTML = `<div class="text-right mb-4">Connect√© en tant que <strong>${currentUser.username}</strong> (${currentUser.role}) <button onclick="logout()" class="text-violet-400 underline">D√©connexion</button></div>`;
      }

      function logout() {
        localStorage.removeItem("user");
        currentUser = null;
        showLogin();
      }

      function renderList() {
        let filtered = [...vehicles];
        const sort = sortSelect.value;
        if (currentFilter !== "all") filtered = filtered.filter(v => v.category === currentFilter);
        if (sort === "price-asc") filtered.sort((a, b) => a.price - b.price);
        if (sort === "price-desc") filtered.sort((a, b) => b.price - a.price);
        if (sort === "speed-asc") filtered.sort((a, b) => a.speed - b.speed);
        if (sort === "speed-desc") filtered.sort((a, b) => b.speed - a.speed);

        listEl.innerHTML = filtered.map(v => `
          <div class="bg-zinc-800 rounded-lg shadow p-4 flex gap-4">
            <img src="${v.image}" alt="${v.model}" class="w-32 h-32 object-cover rounded" />
            <div>
              <h2 class="text-xl font-bold text-violet-300">${v.model}</h2>
              <p class="text-lg">üí∂ ${v.price.toLocaleString()} ‚Ç¨</p>
              <p>üöó Vitesse max : ${v.speed} km/h</p>
              <p>‚è±Ô∏è 0-100 : ${v.acceleration} s</p>
              ${currentUser && currentUser.role === 'client' ? `<button class="mt-2 bg-violet-600 text-white px-3 py-1 rounded" onclick='openPopup(${JSON.stringify(v)})'>Commander</button>` : ''}
            </div>
          </div>
        `).join("");
      }

      function openPopup(vehicle) {
        selectedVehicle = vehicle;
        selectedColor = null;
        popup.classList.remove("hidden");
        document.querySelectorAll("#order-popup [data-color]").forEach(el => {
          el.addEventListener("click", () => {
            selectedColor = el.dataset.color;
            document.querySelectorAll("#order-popup [data-color]").forEach(c => c.classList.remove("ring", "ring-2"));
            el.classList.add("ring", "ring-2", "ring-violet-600");
          });
        });
      }

      document.getElementById("confirm-order").addEventListener("click", () => {
        if (!selectedColor) return alert("Choisissez une couleur !");
        const order = { user: currentUser.username, vehicle: selectedVehicle.model, color: selectedColor, price: selectedVehicle.price, date: new Date().toLocaleString() };
        let orders = JSON.parse(localStorage.getItem("orders")) || [];
        orders.push(order);
        localStorage.setItem("orders", JSON.stringify(orders));
        popup.classList.add("hidden");
        alert("Commande envoy√©e !");
      });

      filterBtns.forEach(btn => {
        btn.addEventListener("click", () => {
          filterBtns.forEach(b => b.classList.remove("bg-violet-600", "text-white"));
          btn.classList.add("bg-violet-600", "text-white");
          currentFilter = btn.dataset.category;
          renderList();
        });
      });

      sortSelect.addEventListener("change", renderList);

      renderAuth();
      renderList();
    </script>
  </body>
</html>


